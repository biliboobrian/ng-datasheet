<table class="table table-sm table-bordered data-grid" (paste)="onPaste($event)" (copy)="onCopy($event)" (cut)="onCut($event)"
  #tbl>
  <tr>
    <th style="width: 26px">
      <div ngbDropdown class="d-inline-block">
        <button class="parameter" id="dropdownBasic1" ngbDropdownToggle>
          <i class="fa fa-cog"></i>
        </button>
        <div ngbDropdownMenu aria-labelledby="dropdownBasic1">
          <button class="dropdown-item" (click)="onSelectAll($event)">Sélectionner tout</button>
          <button class="dropdown-item" (click)="onUnselectAll($event)">Désélectionner tout</button>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item">Opération spéciale</button>
        </div>
      </div>
    </th>
    <th *ngFor="let column of columns" (click)="onSort($event, column)" [ngStyle]="getColumnWidth(column)">
      <span>{{ column.title }}</span>
      <div class="text-right float-right" *ngIf="column.sortable">

        <i *ngIf="isColumnSorted(column.data) === 1" class="fa fa-sort-up"></i>
        <i *ngIf="isColumnSorted(column.data) === -1" class="fa fa-sort-down"></i>
        <i *ngIf="isColumnSorted(column.data) === 0" class="fa fa-sort"></i>
      </div>
    </th>
  </tr>
  <tr>
    <td style="width: 26px"></td>
    <td *ngFor="let column of columns; let col = index" class="header">
      <div class="inner-addon right-addon" *ngIf="column.searchable">
        <input [(ngModel)]="filters[column.data]" type="text" class="form-control filter" placeholder="{{ column.title }} .."
          (keyup)="onFilterChange($event, col)" />
        <i class="fa fa-filter"></i>
      </div>
    </td>
  </tr>
  <ng-container *ngFor="let obj of dataSet; let row = index">
    <tr *ngIf="isVisible(row)">
      <td>
        <input *ngIf="isNeededForAdd(row)" [(ngModel)]="selection[row]" type="checkbox" class="checkbox" />
      </td>
      <ng-container *ngFor="let column of columns; let col = index">
        <td (mousedown)="onMouseDown($event, obj, row, col)" (mouseup)="onMouseUp($event, obj, row, col)" (mouseover)="onMouseOver($event, obj, row, col)"
          (dblclick)="onDblClick($event, row, col)" [class.cell-selected]="isSelected(row, col)" [class.cell-selected-main]="isSelectedMain(row, col)"
          [class.cell-selected-up]="isSelected(row, col, 1)" [class.cell-selected-right]="isSelected(row, col, 2)" [class.cell-selected-down]="isSelected(row, col, 3)"
          [class.cell-selected-left]="isSelected(row, col, 4)" [class.cell-edited]="isEdited(row, col)">
          <ds-cell *ngIf="!isEdited(row, col)" [component]="column.cellView" (key)="onKeyView($event)"
            [column]="column" [data]="obj"></ds-cell>
          <ds-cell *ngIf="isEdited(row, col)" [component]="column.cellEdit" (key)="onKeyEdit($event)"
            [column]="column" [data]="obj"></ds-cell>
        </td>
      </ng-container>
    </tr>
  </ng-container>
  <tr *ngIf="withAdd && newModelFunction">
    <td style="width: 26px"></td>
    <ng-container *ngFor="let column of columns; let col = index">
      <td (mousedown)="onMouseDown($event, newModel, -1, col)" (mouseup)="onMouseUp($event, newModel, -1, col)" (mouseover)="onMouseOver($event, newModel, -1, col)"
        (dblclick)="onDblClick($event, -1, col)" [class.cell-selected]="isSelected(-1, col)" [class.cell-selected-main]="isSelectedMain(-1, col)"
        [class.cell-selected-up]="isSelected(-1, col, 1)" [class.cell-selected-right]="isSelected(-1, col, 2)" [class.cell-selected-down]="isSelected(-1, col, 3)"
        [class.cell-selected-left]="isSelected(-1, col, 4)" [class.cell-edited]="isEdited(-1, col)">
        <ds-cell *ngIf="!isEdited(-1, col) && isNeededForAdd(col)" [component]="column.cellView" (key)="onKeyView($event)"
          [column]="column" [data]="newModel"></ds-cell>
        <ds-cell *ngIf="isEdited(-1, col) && isNeededForAdd(col)" [component]="column.cellEdit" (key)="onKeyEdit($event)"
          [column]="column" [data]="newModel"></ds-cell>
      </td>
    </ng-container>
  </tr>
</table>
<div class="select">
  <textarea (paste)="onPaste($event)" (copy)="onCopy($event)" (cut)="onCut($event)" (keydown)="onKeyDown($event)" (keyup)="onKeyUp($event)"
    #selectBox tabIndex="-1"></textarea>
</div>